### 网格仓&承运商业务逻辑梳理

#### 1. 网格仓

##### 1.1 计费逻辑

网格仓计费逻辑分为两类：总数计费、阶梯计费

###### 1.1.1 总数计费

```java
if(支持保底 && 总数小于保底数) {
  总费用 = 计费单价 * 保底数
} else {
  总费用 = 计费单价 * 数量；
}
// 示例：保底1000件，单价1元 （保底类似于出租车的起步价）
// 当总数=500时，总价=保底*单价=1000*1=1000
// 当总数=1500时，总价=总数*单价=1500*1=1500
```

###### 1.1.2 阶梯计费

```java
if(支持保底 && 总数小于保底数) {
  总费用 = 最低档计费单价 * 保底数;
} else {
  总费用 = 区间增量*区间计费单价;
}
// 示例：保底1000件，1至2000件0.5元，2001至3000件0.8元，3001至无上限1元
// 当总数=500件时，总价=保底数*最低档计费单价=2000*0.5=1000
// 当总数=5000件时，总价=第一区间增量*第一区间单价+第二区间增量*第二区间单价+第三区间增量*第三区间单价=2000*0.5+（3000-2000）*0.8+（5000-3000）*1
```

##### 1.2 业务流程

![image-20210208212537041](/Users/didi/Documents/image-20210208212537041.png)

#### 2. 承运商

##### 2.1 计费逻辑

计费规则很复杂，涉及：线路（直配&支线）、车型（小型&中型）、里程、货量、团点数量、重量、时长、串点、装卸费、逆向数量、起步价等

##### 2.2 业务流程

![image-20210208215737817](/Users/didi/Documents/image-20210208215737817.png)







